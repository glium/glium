<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `token_store` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, token_store">

    <title>token_store - Rust</title>

    <link rel="stylesheet" type="text/css" href="../normalize.css">
    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc mod">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'>Crate token_store</p><div class="block items"><ul><li><a href="#structs">Structs</a></li></ul></div><p class='location'></p><script>window.sidebarCurrent = {name: 'token_store', ty: 'mod', relpath: '../'};</script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content">
<h1 class='fqn'><span class='in-band'>Crate <a class="mod" href=''>token_store</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a class='srclink' href='../src/token_store/lib.rs.html#1-480' title='goto source code'>[src]</a></span></h1>
<div class='docblock'>
<h1 id='token-store' class='section-header'><a href='#token-store'>Token Store</a></h1>
<p>This crate provides a small abstraction of a type allowing
you to stroe values of arbitrary types and retrieving them
using tokens values that are cheap to move around and clone.</p>

<p>The typical use-case is a data store shared by large portions
of an application requiring sequential access to parts of this
store, but while not caring nor being able to know what else
is stored in it.</p>

<h2 id='how-to-use-it' class='section-header'><a href='#how-to-use-it'>How to use it</a></h2>
<pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">token_store</span>::<span class="ident">Store</span>;

<span class="comment">// create a store</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">store</span> <span class="op">=</span> <span class="ident">Store</span>::<span class="ident">new</span>();

<span class="comment">// insert some things in it, you are given tokens</span>
<span class="kw">let</span> <span class="ident">token1</span> <span class="op">=</span> <span class="ident">store</span>.<span class="ident">insert</span>(<span class="number">42</span>);
<span class="comment">// you can store any type as log as it is `Any + &#39;static`</span>
<span class="kw">let</span> <span class="ident">token2</span> <span class="op">=</span> <span class="ident">store</span>.<span class="ident">insert</span>(<span class="ident">String</span>::<span class="ident">from</span>(<span class="string">&quot;I like trains&quot;</span>));
<span class="comment">// the tokens keep the information of the store type,</span>
<span class="comment">// as such you don&#39;t need any annotation to retrieve a value:</span>
<span class="ident">store</span>.<span class="ident">get_mut</span>(<span class="kw-2">&amp;</span><span class="ident">token2</span>).<span class="ident">push_str</span>(<span class="string">&quot;, and cars too!&quot;</span>);</pre>

<p>The retrieved tokens can be cloned and shared as you like between various
parts of your code.</p>

<p>Note however that, as it is possible to store <code>!Send</code> types in the <code>token_store</code>,
neither the store nor its tokens can be shared accross threads.</p>

<h2 id='value-scopes-and-genericity' class='section-header'><a href='#value-scopes-and-genericity'>Value scopes and genericity</a></h2>
<p>It is also possible to access simultaneously several values of the store using
a scoped access:</p>

<pre class="rust rust-example-rendered">
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">store</span> <span class="op">=</span> <span class="ident">Store</span>::<span class="ident">new</span>();
<span class="kw">let</span> <span class="ident">token</span> <span class="op">=</span> <span class="ident">store</span>.<span class="ident">insert</span>(<span class="number">42</span>);
<span class="ident">store</span>.<span class="ident">with_value</span>(<span class="kw-2">&amp;</span><span class="ident">token</span>, <span class="op">|</span><span class="ident">proxy</span>, <span class="ident">value</span><span class="op">|</span> {
    <span class="comment">// Here, proxy is a `StoreProxy`, it allows you to to all you want with the</span>
    <span class="comment">// store, as long as you do not try to access again the value guarded by</span>
    <span class="comment">// the token provided to `with_value`.</span>
    <span class="comment">// Also, value is a mutable reference to the value guarded by this token.</span>

    <span class="comment">// You can nest calls to `with_value` to access several values simultaneously</span>
    <span class="kw">let</span> <span class="ident">token2</span> <span class="op">=</span> <span class="ident">proxy</span>.<span class="ident">insert</span>(<span class="ident">String</span>::<span class="ident">new</span>());
    <span class="ident">proxy</span>.<span class="ident">with_value</span>(<span class="kw-2">&amp;</span><span class="ident">token2</span>, <span class="op">|</span><span class="ident">proxy</span>, <span class="ident">value2</span><span class="op">|</span> {
        <span class="comment">// Here you can access value, value2, as well as a proxy tracking that</span>
        <span class="comment">// both values are borrowed</span>
    });
});</pre>

<p>Two implementations of the <code>From</code> trait are also provided, allowing you to convert
both a <code>&amp;mut Store</code> and a <code>&amp;mut StoreProxy</code> into a <code>StoreProxy</code>. This is to help
generic code like this:</p>

<pre class="rust rust-example-rendered">
<span class="kw">fn</span> <span class="ident">do_stuff</span><span class="op">&lt;</span><span class="lifetime">&#39;store</span>, <span class="ident">S</span>: <span class="ident">Into</span><span class="op">&lt;</span><span class="ident">StoreProxy</span><span class="op">&lt;</span><span class="lifetime">&#39;store</span><span class="op">&gt;&gt;</span><span class="op">&gt;</span>(<span class="ident">s</span>: <span class="ident">S</span>) {
    <span class="kw">let</span> <span class="ident">proxy</span> <span class="op">=</span> <span class="ident">s</span>.<span class="ident">into</span>();
    <span class="comment">// we now have a store proxy, and can do our stuff with it</span>
    <span class="comment">// and the caller can call us directly with a `&amp;mut Store` or</span>
    <span class="comment">// from within a value scope.</span>
}</pre>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class="struct" href="struct.Store.html"
                                  title='struct token_store::Store'>Store</a></td>
                           <td class='docblock-short'>
                                <p>A token store</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class="struct" href="struct.StoreProxy.html"
                                  title='struct token_store::StoreProxy'>StoreProxy</a></td>
                           <td class='docblock-short'>
                                <p>A Proxy representing a <code>Store</code> with ongoing borrows</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class="struct" href="struct.Token.html"
                                  title='struct token_store::Token'>Token</a></td>
                           <td class='docblock-short'>
                                <p>A token for accessing the store contents</p>
                           </td>
                       </tr></table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>↑</dt>
                    <dd>Move up in search results</dd>
                    <dt>↓</dt>
                    <dd>Move down in search results</dd>
                    <dt>↹</dt>
                    <dd>Switch tab</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt style="width:31px;">+ / -</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "token_store";
    </script>
    <script src="../main.js"></script>
    <script defer src="../search-index.js"></script>
</body>
</html>