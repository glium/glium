<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Adding a texture | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./tuto-07-shape.html" />
    
    
    <link rel="prev" href="./tuto-05-colors.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="1.6"
        data-chapter-title="Adding a texture"
        data-filepath="tuto-06-texture.md"
        data-basepath="."
        data-revision="Tue Jan 16 2018 16:47:08 GMT-0800 (PST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Tutorial</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="tuto-01-getting-started.html">
            
                
                    <a href="./tuto-01-getting-started.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Opening a window
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="tuto-02-triangle.html">
            
                
                    <a href="./tuto-02-triangle.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Drawing a triangle
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="tuto-03-animated-triangle.html">
            
                
                    <a href="./tuto-03-animated-triangle.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Uniforms
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="tuto-04-matrices.html">
            
                
                    <a href="./tuto-04-matrices.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Matrices
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="tuto-05-colors.html">
            
                
                    <a href="./tuto-05-colors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        Adding colors
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="1.6" data-path="tuto-06-texture.html">
            
                
                    <a href="./tuto-06-texture.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                        Adding a texture
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="tuto-07-shape.html">
            
                
                    <a href="./tuto-07-shape.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.7.</b>
                        
                        A more complex shape
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="tuto-08-gouraud.html">
            
                
                    <a href="./tuto-08-gouraud.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.</b>
                        
                        Gouraud shading
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="tuto-09-depth.html">
            
                
                    <a href="./tuto-09-depth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.9.</b>
                        
                        Depth testing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="tuto-10-perspective.html">
            
                
                    <a href="./tuto-10-perspective.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.10.</b>
                        
                        Adjusting the perspective
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="tuto-11-backface-culling.html">
            
                
                    <a href="./tuto-11-backface-culling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.11.</b>
                        
                        Backface culling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="tuto-12-camera.html">
            
                
                    <a href="./tuto-12-camera.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.12.</b>
                        
                        The camera and summary of the vertex processing stages
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="tuto-13-phong.html">
            
                
                    <a href="./tuto-13-phong.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.13.</b>
                        
                        Blinn-phong shading
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="tuto-14-wall.html">
            
                
                    <a href="./tuto-14-wall.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.14.</b>
                        
                        Normal mapping
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
            <span><b>1.15.</b> Parallax mapping</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.16" >
            
            <span><b>1.16.</b> Deferred shading</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.17" >
            
            <span><b>1.17.</b> Shadow mapping</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.18" >
            
            <span><b>1.18.</b> Antialiasing</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.19" >
            
            <span><b>1.19.</b> Drawing lots of objects with instancing</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="perf-intro.html">
            
                
                    <a href="./perf-intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Performances
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="perf-sync.html">
            
                
                    <a href="./perf-sync.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Synchronization
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="uploading-a-texture">Uploading a texture</h1>
<p>A texture is an image or a collection of images loaded in the video memory.</p>
<p>In order to load a texture, we must first decode the image format that stores our image (for example, PNG). To do so, we are going to use the <code>image</code> library. Let&apos;s add it to the Cargo.toml file:</p>
<pre><code class="lang-toml"><span class="hljs-title">[dependencies]</span>
<span class="hljs-setting">image = <span class="hljs-value"><span class="hljs-string">&quot;*&quot;</span></span></span>
</code></pre>
<p>And to the crate root:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">crate</span> image;
</code></pre>
<p>In order to load the image, we just need to use <code>image::load</code>:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">use</span> std::io::Cursor;
<span class="hljs-keyword">let</span> image = image::load(Cursor::new(&amp;include_bytes!(<span class="hljs-string">&quot;/path/to/image.png&quot;</span>)[..]),
                        image::PNG).unwrap().to_rgba();
<span class="hljs-keyword">let</span> image_dimensions = image.dimensions();
<span class="hljs-keyword">let</span> image = glium::texture::RawImage2d::from_raw_rgba_reversed(&amp;image.into_raw(), image_dimensions);
</code></pre>
<p>And in order to upload the image as a texture, it&apos;s as simple as:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> texture = glium::texture::Texture2d::new(&amp;display, image).unwrap();
</code></pre>
<h1 id="using-the-texture">Using the texture</h1>
<p>There is no automatic way to display a texture over a shape with OpenGL. Just like any other rendering techniques, it must be done manually. This means that we must manually load color values from our texture and return them with our fragment shader.</p>
<p>To do so, we first have to modify a bit our shape in order to indicate to which location of the texture each vertex is attached to:</p>
<pre><code class="lang-rust"><span class="hljs-preprocessor">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> Vertex {
    position: [<span class="hljs-keyword">f32</span>; <span class="hljs-number">2</span>],
    tex_coords: [<span class="hljs-keyword">f32</span>; <span class="hljs-number">2</span>],       <span class="hljs-comment">// &lt;- this is new</span>
}

implement_vertex!(Vertex, position, tex_coords);        <span class="hljs-comment">// don&apos;t forget to add `tex_coords` here</span>

<span class="hljs-keyword">let</span> vertex1 = Vertex { position: [-<span class="hljs-number">0.5</span>, -<span class="hljs-number">0.5</span>], tex_coords: [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>] };
<span class="hljs-keyword">let</span> vertex2 = Vertex { position: [ <span class="hljs-number">0.0</span>,  <span class="hljs-number">0.5</span>], tex_coords: [<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>] };
<span class="hljs-keyword">let</span> vertex3 = Vertex { position: [ <span class="hljs-number">0.5</span>, -<span class="hljs-number">0.25</span>], tex_coords: [<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>] };
<span class="hljs-keyword">let</span> shape = <span class="hljs-built_in">vec!</span>[vertex1, vertex2, vertex3];
</code></pre>
<p>Texture coordinates range from <code>0.0</code> to <code>1.0</code>. The coordinates <code>(0.0, 0.0)</code> correspond to the bottom-left hand corner of the texture, and <code>(1.0, 1.0)</code> to the top-right hand corner.</p>
<p>This new <code>tex_coords</code> attribute will be passed to the vertex shader, just like <code>position</code>. We don&apos;t have anything to do with it, and we are just going to pass it through to the fragment shader:</p>
<pre><code class="lang-glsl"><span class="hljs-preprocessor">#version 140</span>

<span class="hljs-keyword">in</span> <span class="hljs-keyword">vec2</span> position;
<span class="hljs-keyword">in</span> <span class="hljs-keyword">vec2</span> tex_coords;
<span class="hljs-keyword">out</span> <span class="hljs-keyword">vec2</span> v_tex_coords;

<span class="hljs-keyword">uniform</span> <span class="hljs-keyword">mat4</span> matrix;

<span class="hljs-keyword">void</span> main() {
    v_tex_coords = tex_coords;
    <span class="hljs-built_in">gl_Position</span> = matrix * <span class="hljs-keyword">vec4</span>(position, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>);
}
</code></pre>
<p>Similarly to the <code>my_attr</code> variable, the value of <code>v_tex_coords</code> will be interpolated so that each pixel gets a value that corresponds to its position. This value corresponds here to the coordinates in the texture that this pixel is attached to.</p>
<p>All that&apos;s left to do in our fragment shader is to get the value of the color at these coordinates in the texture with the <code>texture()</code> function that is provided by OpenGL.</p>
<pre><code class="lang-glsl"><span class="hljs-preprocessor">#version 140</span>

<span class="hljs-keyword">in</span> <span class="hljs-keyword">vec2</span> v_tex_coords;
<span class="hljs-keyword">out</span> <span class="hljs-keyword">vec4</span> color;

<span class="hljs-keyword">uniform</span> <span class="hljs-keyword">sampler2D</span> tex;

<span class="hljs-keyword">void</span> main() {
    color = <span class="hljs-built_in">texture</span>(tex, v_tex_coords);
}
</code></pre>
<p>As you can see, a texture is a <code>uniform</code> of type <code>sampler2D</code>. There are many types of textures and texture uniforms, and <code>sampler2D</code> corresponds to a simple two-dimensional texture.</p>
<p>Since the texture is a uniform, we have to pass a reference to it when drawing in the Rust code:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">let</span> uniforms = uniform! {
    matrix: [
        [<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>],
        [<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>],
        [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>],
        [ t , <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0f32</span>],
    ],
    tex: &amp;texture,
};
</code></pre>
<p>And here is the result:</p>
<p><img src="tuto-06-texture.png" alt="The result"></p>
<p><strong><a href="https://github.com/glium/glium/blob/master/examples/tutorial-06.rs" target="_blank">You can find the entire source code here</a>.</strong></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./tuto-05-colors.html" class="navigation navigation-prev " aria-label="Previous page: Adding colors"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./tuto-07-shape.html" class="navigation navigation-next " aria-label="Next page: A more complex shape"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
