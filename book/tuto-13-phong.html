<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Blinn-phong shading | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./tuto-14-wall.html" />
    
    
    <link rel="prev" href="./tuto-12-camera.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="1.13"
        data-chapter-title="Blinn-phong shading"
        data-filepath="tuto-13-phong.md"
        data-basepath="."
        data-revision="Tue Jan 16 2018 16:47:08 GMT-0800 (PST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Tutorial</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="tuto-01-getting-started.html">
            
                
                    <a href="./tuto-01-getting-started.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Opening a window
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="tuto-02-triangle.html">
            
                
                    <a href="./tuto-02-triangle.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Drawing a triangle
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="tuto-03-animated-triangle.html">
            
                
                    <a href="./tuto-03-animated-triangle.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Uniforms
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="tuto-04-matrices.html">
            
                
                    <a href="./tuto-04-matrices.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Matrices
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="tuto-05-colors.html">
            
                
                    <a href="./tuto-05-colors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        Adding colors
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="tuto-06-texture.html">
            
                
                    <a href="./tuto-06-texture.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                        Adding a texture
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="tuto-07-shape.html">
            
                
                    <a href="./tuto-07-shape.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.7.</b>
                        
                        A more complex shape
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="tuto-08-gouraud.html">
            
                
                    <a href="./tuto-08-gouraud.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.</b>
                        
                        Gouraud shading
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="tuto-09-depth.html">
            
                
                    <a href="./tuto-09-depth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.9.</b>
                        
                        Depth testing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="tuto-10-perspective.html">
            
                
                    <a href="./tuto-10-perspective.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.10.</b>
                        
                        Adjusting the perspective
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="tuto-11-backface-culling.html">
            
                
                    <a href="./tuto-11-backface-culling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.11.</b>
                        
                        Backface culling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="tuto-12-camera.html">
            
                
                    <a href="./tuto-12-camera.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.12.</b>
                        
                        The camera and summary of the vertex processing stages
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="1.13" data-path="tuto-13-phong.html">
            
                
                    <a href="./tuto-13-phong.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.13.</b>
                        
                        Blinn-phong shading
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="tuto-14-wall.html">
            
                
                    <a href="./tuto-14-wall.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.14.</b>
                        
                        Normal mapping
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
            <span><b>1.15.</b> Parallax mapping</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.16" >
            
            <span><b>1.16.</b> Deferred shading</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.17" >
            
            <span><b>1.17.</b> Shadow mapping</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.18" >
            
            <span><b>1.18.</b> Antialiasing</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.19" >
            
            <span><b>1.19.</b> Drawing lots of objects with instancing</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="perf-intro.html">
            
                
                    <a href="./perf-intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Performances
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="perf-sync.html">
            
                
                    <a href="./perf-sync.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Synchronization
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="blinnphong-shading">Blinn-phong shading</h1>
<p>Our current lighting model is a bit primitive.
We are going to modify it to use what is called <em>Blinn-Phong shading</em>.</p>
<p>This model is still very often used in commercial games, and has only recently been
superseded by physical-based rendering.</p>
<h2 id="specular-reflection">Specular reflection</h2>
<p>So what exactly is wrong with our current lighting?</p>
<p>When light hits an object, the light rays are split in two:</p>
<ul>
<li>Some rays will be reflected in all directions. This is diffuse reflection.</li>
<li>Some rays will be reflected perpendicularly to the surface&apos;s normal, as if the object was a
mirror. This is specular reflection.</li>
</ul>
<p>When you take an individual fragment, the fragment&apos;s color is a combination of its diffuse and
specular reflections. Our current shader only takes into account diffuse reflection and not
specular.</p>
<p>So how does the calculation look like?</p>
<pre><code class="lang-glsl"><span class="hljs-preprocessor">#version 140</span>

<span class="hljs-keyword">in</span> <span class="hljs-keyword">vec3</span> v_normal;
<span class="hljs-keyword">in</span> <span class="hljs-keyword">vec3</span> v_position;

<span class="hljs-keyword">out</span> <span class="hljs-keyword">vec4</span> color;

<span class="hljs-keyword">uniform</span> <span class="hljs-keyword">vec3</span> u_light;

<span class="hljs-keyword">const</span> <span class="hljs-keyword">vec3</span> ambient_color = <span class="hljs-keyword">vec3</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);
<span class="hljs-keyword">const</span> <span class="hljs-keyword">vec3</span> diffuse_color = <span class="hljs-keyword">vec3</span>(<span class="hljs-number">0.6</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);
<span class="hljs-keyword">const</span> <span class="hljs-keyword">vec3</span> specular_color = <span class="hljs-keyword">vec3</span>(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>);

<span class="hljs-keyword">void</span> main() {
    <span class="hljs-keyword">float</span> diffuse = <span class="hljs-built_in">max</span>(<span class="hljs-built_in">dot</span>(<span class="hljs-built_in">normalize</span>(v_normal), <span class="hljs-built_in">normalize</span>(u_light)), <span class="hljs-number">0.0</span>);

    <span class="hljs-keyword">vec3</span> camera_dir = <span class="hljs-built_in">normalize</span>(-v_position);
    <span class="hljs-keyword">vec3</span> half_direction = <span class="hljs-built_in">normalize</span>(<span class="hljs-built_in">normalize</span>(u_light) + camera_dir);
    <span class="hljs-keyword">float</span> specular = <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">max</span>(<span class="hljs-built_in">dot</span>(half_direction, <span class="hljs-built_in">normalize</span>(v_normal)), <span class="hljs-number">0.0</span>), <span class="hljs-number">16.0</span>);

    color = <span class="hljs-keyword">vec4</span>(ambient_color + diffuse * diffuse_color + specular * specular_color, <span class="hljs-number">1.0</span>);
}
</code></pre>
<p>The first line of the main function is more or less the same as what our previous shader was,
except that this time we fix the value so that it cannot be negative. This was not necessary
before because we used the <code>mix</code> function (which automatically handles this), but now we must
do it.</p>
<p>Then we calculate <code>camera_dir</code>, which is the direction of the camera relative to the object.
Since the camera is always at <code>(0, 0, 0)</code>, this is calculated simply by taking the opposite
of the position of the vector.</p>
<p><img src="tuto-13-specular.png" alt="A schema of what&apos;s happening"></p>
<p>Afterwards we calculate <code>half_direction</code>, which is the direction of the camera relative to
the light if the camera and the light were both one unit away from the object. We then
calculate the cosine of the angle between <code>half_direction</code> and <code>v_normal</code> with
<code>dot(half_direction, normalize(v_normal))</code>.</p>
<p>If the <code>half_direction</code> is perpendicular to the normal, that means that the light rays coming
from the light bounce directly into the camera. The result of the calculation will be <code>1.0</code>.
Then we ensure that this value is positive and elevate it to the power 16. This means that
values like <code>0.98</code> will stay high, but values like <code>0.8</code> will almost drop to 0. The role of this
power is to mark a border between high values and low values. This is our specular coefficient.</p>
<p>The last step is to add everything together: ambient lighting (which is the lighting that
is present even if there is no light source) + diffuse lighting + specular lighting. Note that
in some circumstances the value can go above <code>1.0</code>, but OpenGL will automatically clamp it
to <code>1.0</code>.</p>
<p>Don&apos;t forget to modify our vertex shader to pass the additional <code>v_position</code> attribute by
adding this line at the end:</p>
<pre><code class="lang-glsl">v_position = <span class="hljs-built_in">gl_Position</span>.xyz / <span class="hljs-built_in">gl_Position</span>.w;
</code></pre>
<p>And here is the result:</p>
<p><img src="tuto-13-result.png" alt="Result"> <img src="tuto-13-result2.png" alt="Result"></p>
<p>The big white spots are the specular reflection.</p>
<p><strong><a href="https://github.com/glium/glium/blob/master/examples/tutorial-13.rs" target="_blank">You can find the entire source code here</a>.</strong></p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./tuto-12-camera.html" class="navigation navigation-prev " aria-label="Previous page: The camera and summary of the vertex processing stages"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./tuto-14-wall.html" class="navigation navigation-next " aria-label="Next page: Normal mapping"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
